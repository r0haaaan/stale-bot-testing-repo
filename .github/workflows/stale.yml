name: "Lifecycle: Mark and close stale issues and pull requests"

on:
  schedule:
    - cron: "0 2 * * *" # Run every day at 02:00 UTC
  workflow_dispatch:

permissions:
  issues: write
  pull-requests: write
  contents: read

jobs:
  stale:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/stale@v10
        with:
          repo-token: ${{ secrets.GITHUB_TOKEN }}

          # --- Issue configuration ---
          days-before-issue-stale: 1
          days-before-issue-close: 1
          stale-issue-message: >
            This issue has been automatically marked as stale due to 180 days of inactivity.

            If this issue is still relevant, please add a comment to keep it open.

            Otherwise, it will be closed after 7 more days of inactivity.

            Moderators: Add the `lifecycle/frozen` label to exempt this issue from the stale process.
          close-issue-message: >
            Closing this issue as it remained inactive after being marked `lifecycle/stale`.

          # --- PR configuration ---
          days-before-pr-stale: 1
          days-before-pr-close: 1
          exempt-draft-pr: false
          stale-pr-message: >
            This pull request has been automatically marked as stale due to 180 days of inactivity.

            Please update it or comment if you intend to continue working on it.

            It will be closed after 7 more days of inactivity.

            Moderators: Add the `lifecycle/frozen` label to exempt this PR from the stale process.
          close-pr-message: >
            Closing this pull request as it remained inactive after being marked `lifecycle/stale`.

          # --- Shared settings ---
          stale-issue-label: "lifecycle/stale"
          stale-pr-label: "lifecycle/stale"
          exempt-issue-labels: "lifecycle/frozen"
          exempt-pr-labels: "lifecycle/frozen"
          remove-issue-stale-when-updated: true
          remove-pr-stale-when-updated: true
          labels-to-remove-when-unstale: "lifecycle/stale"
          sort-by: "created"
          start-date: "2025-11-03T00:24:55Z"
          operations-per-run: 100
